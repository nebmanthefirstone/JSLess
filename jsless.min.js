/*
 * JSLess Library - Core
 * https://github.com/realstrategos/JSLess
 * *
 * Copyright 2013 OptixConnect LLC and other contributors
 * Released under the Creative Commons Attribution NonCommercial (CC-NC)
 * http://creativecommons.org/licenses/by-nc/3.0/legalcode
 *
 */
!function(a){var e=window.console||{log:function(){},error:function(k){alert(k)},info:function(){},warn:function(){},debug:function(){}};var f=["log","error","warn","debug","info"];var h={};for(var d in f){var i=f[d];h[i]=(function(k){return function(l){if(k=="log"){if(jsless.log){e[k]("JSLess: "+l)}}else{if(k=="debug"){if(jsless.debug){e[k]("JSLess: "+l)}}else{e[k]("JSLess: "+l)}}}})(i)}function g(k,l){var m=[];k.find(l).each(function(o,n){if(a(n).parentsUntil(k,l).length==0){m.push(n)}});return a(m)}var j=new Date();var c=0;window.jsless=a.extend(true,{debug:false,log:true,logger:h},window.jsless||{});var b={settings:{selector:{target:"self",scope:"widget",latebind:true}},behaviors:{},_methods:{},process:function(k,q,p){if(k.is("script")){return}if(q&&q.debug){jsless.debug=q.debug}var r=a.extend(true,{},this.settings,q);var o=new Date();if(!p){c=0;j=o}var n=k;if(!k.attr("data-jsless-widget")){n=k.parents("[data-jsless-widget]").first();if(n.length==0){n=a("body");h.info("declared body as root widget");n.attr("data-jsless-widget","root")}else{h.log("missing data-jsless-widget, treating as a partial")}}var s=n.attr("data-jsless-widget");var l=k.find("[data-jsless-widget]");l=l.filter(function(t){var u=a(this).parentsUntil(k,"[data-jsless-widget]").length==0;return u});var m=k.find("[data-jsless]").addBack("[data-jsless]");m=m.filter(function(t){var u=a(this).parentsUntil(k.parent(),"[data-jsless-widget][data-jsless-widget!="+s+"]").length==0;return u});h.log("found: "+m.length+" elements and "+l.length+" sub widgets ...");m.each(function(w,v){var t=a(v);var u=a.parseJSON(t.attr("data-jsless"));a(u).each(function(y,x){jsless.processBehavior(n,t,x,r)})});l.each(function(v,u){h.log("processing subwidget ...");var t=a(u);jsless.process(t,q,true)});if(!p){h.log("processed: "+c+" behaviors in "+(new Date()-o)+"ms")}n.triggerHandler("jsless-widget-complete");n.trigger("jsless-widget-loaded")},processBehavior:function(l,k,m,o){c++;var n=m.name;if(jsless.behaviors[n]===undefined){if(n=="html"||n=="htmlform"){jsless._methods[n](l,k,m,o)}else{h.error("Behavior not found: "+n);return}}else{jsless.behaviors[n](l,k,m,o)}if(o.debug){h.debug("behavior: "+n+" processed in "+(new Date()-j)+"ms");j=new Date()}}};a.fn.jsless=function(k){return this.each(function(){var l=a(this);jsless.process(l,k)})};if(a.fn.toggleProp===undefined){a.fn.toggleProp=function(k){return this.each(function(){var l=a(this);l.prop(k,!l.prop(k))})}}h.info("Loading Core...");window.jsless=a.extend(true,b,window.jsless||{});setTimeout(function(){jsless.debug=false},0)}(window.jQuery);/*
 * JSLess Library - AJAX Invoke
 * https://github.com/realstrategos/JSLess
 * *
 * Copyright 2013 OptixConnect LLC and other contributors
 * Released under the Creative Commons Attribution NonCommercial (CC-NC)
 * http://creativecommons.org/licenses/by-nc/3.0/legalcode
 *
 */
!function(a){var f=jsless.logger;var c=function(h,i){this.invoker=h;this.request=i;this.errormessage=null;this.success=true;if(i.status!=200){this.errormessage=i.status+" Error: "+i.statusText;this.success=false}var g=i.responseText;this.isHTML=true;if(i.responseJSON){this.isHTML=false;g=i.responseJSON}if(!this.isHTML){g=d(g);if(g.d&&Object.keys(g).length==1){g=g.d}}this.data=g};if(!Object.keys){Object.keys=(function(){var j=Object.prototype.hasOwnProperty,i=!({toString:null}).propertyIsEnumerable("toString"),g=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],h=g.length;return function(l){if(typeof l!=="object"&&(typeof l!=="function"||l===null)){throw new TypeError("Object.keys called on non-object")}var n=[],m,k;for(m in l){if(j.call(l,m)){n.push(m)}}if(i){for(k=0;k<h;k++){if(j.call(l,g[k])){n.push(g[k])}}}return n}}())}var d=function(i){if(i===null){return i}if(typeof i==="string"){var j=/\/Date\(\d+\)\//;var g=i.match(j);if(!g){return i}var g=g[0].match(/\d+/);var h=parseInt(g[0]);return new Date(h)}if(typeof i!=="object"){return i}var k=a.proxy(d,this);a.each(i,function(l,m){i[l]=k(m)});return i};var e=function(g){this.settings=a.extend({},this.settings,g);if(this.settings.onComplete==null){throw"missing option onComplete"}a(window).bind("invoke-abort",this.Abort);if(this.settings.category){a(window).bind("invoke-abort-"+this.settings.category,this.Abort)}this._Start()};e.prototype={settings:{url:null,category:"normal",datatype:"json",method:"GET",subdomain:null,params:null,onComplete:null,retryCount:0},failCount:0,_request:null,Retry:function(){this.Start()},_Start:function(){var g=function(p,o){this._running=false;if(p.status==401){f.warn("Attempted to access an UnAuthorized Page");a(window).trigger("invoke-authorizationerror",this._request);return}var n=new c(this,p);if(n.errormessage){this.failCount++}this.settings.onComplete(n)};if(this._running){return false}this._running=true;this._request=null;var m=this.settings.url;var l=this.settings.method;var i=this.settings.params;var j=this.settings.datatype;if(this.settings.subdomain){m=location.protocol+"//"+subDomain+"."+location.host+m;j="jsonp"}var k=a.postify(i);var h="application/json; charset=utf-8";this._request=a.ajax({url:m,type:l,dataType:j,data:k,cache:false,traditional:true,complete:a.proxy(g,this)});return true},Abort:function(){this.settings.onComplete=null;this.settings.onFail=null;this._running=false;if(this._request){try{this._request.abort()}catch(g){}}}};a.postify=function(i){var h={};var g=function(k,m){for(var j in k){if(k[j]==null){k[j]=""}var l=isFinite(j)?(m!=""?m:"")+"["+j+"]":(m!=""?m+".":"")+j;switch(typeof(k[j])){case"number":case"string":case"boolean":h[l]=k[j];break;case"object":if(k[j].toUTCString){h[l]=k[j].toUTCString().replace("UTC","GMT")}else{g(k[j],l!=""?l:j)}}}};g(i,"");return h};a.fn.jsless_invoke=function(g){var h=jsless.invoke(g)};var b={invoke:function(h){var g=new e(h);return g}};f.info("Loading Invoke ...");window.jsless=a.extend(true,b,window.jsless||{})}(window.jQuery);/*
 * JSLess Library - Builtin Methods
 * https://github.com/realstrategos/JSLess
 * *
 * Copyright 2013 OptixConnect LLC and other contributors
 * Released under the Creative Commons Attribution NonCommercial (CC-NC)
 * http://creativecommons.org/licenses/by-nc/3.0/legalcode
 *
 */
!function(a){var c=jsless.logger;var b={settings:{method:{name:null,onSuccess:"widget",onFail:"widget",eventSource:"self",params:{dynamic:{},forms:[]}}},getSelector:function(h,f,d){if(h==null){throw"selector is null"}var e=null;var i={target:null,scope:"widget",latebind:true,mode:"html",getVal:function(){return e}};if(typeof h==="object"&&!(h instanceof jQuery)){a.extend(i,h)}else{i.target=h}var g=function(){var j=null;if(i.scope=="widget"){j=f}else{if(i.scope=="self"){j=d}else{if(i.scope=="document"){j=a(document)}else{j=a(i.scope)}}}var k=j;if(i.target!=null){k=j.find(i.target)}return k};if(h=="self"){e=d}else{if(h=="widget"){i.mode="replaceWith";e=f}else{if(i.latebind){i.getVal=g}else{e=g()}}}return i},compileParams:function(h,e,d){var i=a.extend({},h);if(i.dynamic){var f={};a.each(i.dynamic,function(j,m){var l={name:null,target:m,object:"jQuery",method:"val",methodparams:[]};if(typeof m==="object"&&!(m instanceof jQuery)){a.extend(l,m)}l=jsless.getSelector(l,e,d);var k=l.name||j;f[k]=function(){var n=l.getVal();var o=n;if(l.object!="jQuery"){o=window[l.object]}var p=o[l.method].apply(n,l.methodparams);return p}});i.dynamic=f}if(i.forms){var g=[];a.each(i.forms,function(k,l){var j=jsless.getSelector(l,e,d);g.push(j)});i.forms=g}return i},getParams:function(d){var g=a.extend({},d);var e={};if(g.dynamic){a.each(g.dynamic,function(j,m){var l=e;var k=null;a.each(j.split("."),function(n,o){if(k!=null){l=l[k]}if(l[o]===undefined){l[o]={}}k=o});l[k]=m()});delete g.dynamic}var f={};if(g.forms){a.each(g.forms,function(m,k){var j=k.getVal();var l=jsless.processContainer(j);a.extend(f,l)});delete g.forms}var i={};a.each(g,function(j,l){var k=j;if(j.indexOf("_dynamic")>0||j.indexOf("_forms")>0){k=j.substr(1)}i[k]=l});var h=a.extend(true,{},f,i,e);return h},getValue:function(d,f,e){if(d.attr("contenteditable")!=null){f[e]=d.html()}else{if(d.is("select[multiple] option:selected")){f[e]=f[e]||[];f[e].push(d.val())}else{if(d.is("input[data-list]:checkbox")){f[e]=f[e]||[];if(d.is(":checked")){f[e].push(d.val())}}else{if(d.is("input[data-list]")){f[e]=f[e]||[];f[e].push(d.val())}else{if(d.is("input:checkbox,input:radio")){if(d.is("input[value]")){if(d.is(":checked")){f[e]=d.val()}}else{f[e]=d.is(":checked")}}else{if(d.is("option:selected")){f[e]=d.val()}else{if(d.is("select")){d.find("option:selected").each(function(g,h){f=jsless.getValue(a(h),f,e)})}else{f[e]=d.val()}}}}}}}return f},processContainer:function(e){var h="[name],[data-list]";var j="input[type!='button'][type!='submit'],select,textarea,[contenteditable]";var f=e.find(h+","+j).filter(function(k){var l=a(this).parentsUntil(e,h).length==0;return l});var g=f.filter(j);var d=f.not(g);var i={};a.each(g,function(m,l){var k=a(l);var n=k.attr("name");if(k.attr("data-list")){n=k.attr("data-list")}else{if(k.attr("data-index")!=null){n+="["+k.attr("data-index")+"]"}}if(n==null){c.warn("element has no name: "+k[0].outerHTML);return}var o=jsless.getValue(k,i,n);i=o});a.each(d,function(m,l){var k=a(l);var o=jsless.processContainer(k);if(k.attr("data-list")!=null){var n=k.attr("data-list");i[n]=i[n]||[];i[n].push(o)}else{var n=k.attr("name");if(k.attr("data-index")!=null){n+="["+k.attr("data-index")+"]"}i[n]=o}});return i},_methods:{html:function(f,d,g,k){var l=a.extend(true,{},jsless.settings.method,k.method,{name:"html",url:null,method:"GET",event:"click",stopEventPropagation:false,onSuccess:"widget",onFail:null,params:{dynamic:{},forms:[]}},g);if(!l.url){c.error("html url not specified: "+JSON.stringify(l))}if(!l.onFail){l.onFail=l.onSuccess}var e=jsless.getSelector(l.eventSource,f,d).getVal();var m=jsless.getSelector(l.onSuccess,f,d);var i=jsless.getSelector(l.onFail,f,d);var h=jsless.compileParams(l.params,f,d);var j=function(n){jsless._methods.htmlevent(n,f,d,l,m,i,h,k)};if(l.event=="load"){f.one("jsless-widget-complete",j)}else{e.bind(l.event,j)}},htmlevent:function(j,g,d,q,r,l,i,n){try{var m=JSON.stringify(q)}catch(k){}c.debug(q.name+" event:"+q.event+"\r\n\t :: "+m);if(q.stopEventPropagation&&q.event!="load"){j.preventDefault()}var o=jsless.getParams(i);var f=r.getVal();var e=l.getVal();var p=d.triggerHandler("jsless-"+q.name+"-begin",[i]);if(p===undefined||p){d.trigger("jsless-ajax-begin");var h={url:q.url,category:"normal",datatype:"json",method:q.method,subdomain:null,params:o,onComplete:function(u){u.success=u.success&&u.isHTML;var s=a(u.data);if(s.attr("data-jsless-error")){u.success=false;u.errormessage=s.attr("data-jsless-error")}var v=r;var t=f;if(!u.success){v=l;t=e;d.trigger("jsless-ajax-beforefail");t.triggerHandler("jsless-"+q.name+"-beforefail")}else{d.trigger("jsless-ajax-beforesuccess");t.triggerHandler("jsless-"+q.name+"-beforesuccess")}d.trigger("jsless-ajax-beforecomplete");t.triggerHandler("jsless-"+q.name+"-beforecomplete");a.each(t,function(z,y){var x=a(y);var w=s.clone();x[v.mode](w);w.jsless(n)});if(u.success){d.trigger("jsless-ajax-success");t.triggerHandler("jsless-"+q.name+"-success")}else{d.trigger("jsless-ajax-fail");t.triggerHandler("jsless-"+q.name+"-fail")}d.trigger("jsless-ajax-complete");t.triggerHandler("jsless-"+q.name+"-complete")},retryCount:0};jsless.invoke(h)}},htmlform:function(f,d,g,h){var i=a.extend(true,{},jsless.settings.method,h.method,{name:"html",url:null,method:"GET",event:d.is("form")?"submit":"click",stopEventPropagation:d.is("form"),onSuccess:"widget",onFail:null,params:{dynamic:{},forms:[]}},g);if(i.params.forms.length==0){if(d.is("form")){c.log("element is form");i.params.forms.push(d)}else{var e=d.parentsUntil(f,"form");if(e.length==1){c.log("element is within form")}else{c.log("element is formless");e=d}i.params.forms.push(e)}}jsless._methods.html(f,d,i,h)}}};c.info("Loading Methods ...");window.jsless=a.extend(true,b,window.jsless||{})}(window.jQuery);/*
 * JSLess Library - Builtin Behaviors
 * https://github.com/realstrategos/JSLess
 * *
 * Copyright 2013 OptixConnect LLC and other contributors
 * Released under the Creative Commons Attribution NonCommercial (CC-NC)
 * http://creativecommons.org/licenses/by-nc/3.0/legalcode
 *
 */
!function(a){var c=jsless.logger;var b={settings:{behavior:{name:null,event:"click",eventSource:"self",target:"self",delay:-1,params:[],dynamic:[],stopEventPropagation:false}},behaviors:{execute:function(f,d,g,j){var k=a.extend(true,{},jsless.settings.behavior,j.behavior,{name:"execute",object:"jQuery",method:null},g);if(!k.method){c.error("execute method not specified: "+JSON.stringify(k))}var h={};a.each(k.dynamic,function(n,o){if(k.dynamic[n]==null){return}var m=jsless.compileParams({dynamic:k.dynamic[n]},f,d);h[n]=m});var e=jsless.getSelector(k.eventSource,f,d).getVal();var l=jsless.getSelector(k.target,f,d);var i=function(o){var p=k.params.slice(0);if(k.stopEventPropagation){o.stopPropagation()}c.debug(k.name+" event:"+k.event+" method: "+k.method+"\r\n\t :: "+JSON.stringify(k));var q=d.triggerHandler("jsless-"+k.name+"-begin");if(q===undefined||q){var m=l.getVal();a.each(h,function(r,s){var t=jsless.getParams(h[r]);if(typeof t==="object"){p[r]=p[r]||{};a.extend(true,p[r],t)}else{p[r]=t}});var n=function(){d.triggerHandler("jsless-"+k.name+"-beforecomplete");var s=m;var r=m[k.method];a.each(p,function(u,v){if(p[u]=="@event"){p[u]=o}if(p[u]=="@target"){p[u]=m}});if(k.object!="jQuery"){var s=window;a.each(k.object.split("."),function(u,v){s=s[v]});var r=s[k.method]}var t=r.apply(s,p);d.triggerHandler("jsless-"+k.name+"-complete")};if(k.delay<0){n()}else{setTimeout(n,k.delay)}}};if(k.event=="load"){f.one("jsless-widget-complete",i)}else{e.bind(k.event,i)}},keyclick:function(f,d,g,h){var j=a.extend(true,{},jsless.settings.behavior,h.behavior,{name:"keyclick",event:"keydown",target:"self",keycode:13},g);var i=j.params;var e=jsless.getSelector(j.eventSource,f,d).getVal();var k=jsless.getSelector(j.target,f,d);e.bind(j.event,function(n){c.debug(j.name+" event:"+j.event+"\r\n\t :: "+JSON.stringify(j));var o=d.triggerHandler("jsless-"+j.name+"-begin");if(o===undefined||o){var m=(n.keyCode?n.keyCode:n.which);if(m==j.keycode){n.preventDefault();var l=k.getVal();l.triggerHandler("click")}}})},toggleClass:function(f,d,g,h){var j=a.extend(true,{},jsless.settings.behavior,h.behavior,{name:"toggleClass",className:null},g);if(!j.className){c.error("className not specified: "+JSON.stringify(j))}var i=j.params;var e=jsless.getSelector(j.eventSource,f,d).getVal();var k=jsless.getSelector(j.target,f,d);e.bind(j.event,function(o){c.debug(j.name+" event:"+j.event+"\r\n\t :: "+JSON.stringify(j));var p=d.triggerHandler("jsless-"+j.name+"-begin");if(p===undefined||p){var m=k.getVal();var l=a(o.target).parents(j.target).addBack(j.target).first();var n=j.className;m.removeClass(n);l.addClass(n)}})},parentTrigger:function(f,d,g,i){var j=a.extend(true,{},jsless.settings.behavior,i.method,{name:"parentTrigger",eventSource:"widget",parentSelector:"[data-jsless-widget]",parentEvent:"jsless-reload",level:1},g);var e=jsless.getSelector(j.eventSource,f,d).getVal();var h=function(l){var k=e;if(j.level>0){k=a(k.parents(j.parentSelector)[j.level-1])}k.triggerHandler(j.parentEvent)};if(j.event=="load"){f.one("jsless-widget-complete",h)}else{e.bind(j.event,h)}}}};c.info("Loading Behaviors ...");window.jsless=a.extend(true,b,window.jsless||{})}(window.jQuery);