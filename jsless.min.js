/*
 * JSLess Library - Core
 * https://github.com/realstrategos/JSLess
 * *
 * Copyright 2013 OptixConnect LLC and other contributors
 * Released under the Creative Commons Attribution NonCommercial (CC-NC)
 * http://creativecommons.org/licenses/by-nc/3.0/legalcode
 *
 */
!function(a){if(!window.console){window.console={}}var j=["log","info","warn","error","debug","trace","dir","group","groupCollapsed","groupEnd","time","timeEnd","profile","profileEnd","dirxml","assert","count","markTimeline","timeStamp","clear"];for(var g=0;g<j.length;g++){if(!window.console[j[g]]){if(j[g]=="error"){window.console[j[g]]=function(i){alert(i)}}window.console[j[g]]=function(){}}}var h={};var e=["log","error","warn","debug","info"];for(var d in e){var k=e[d];h[k]=(function(i){return function(m){if(i=="log"){if(jsless.log){console[i]("JSLess: "+m)}}else{if(i=="debug"){if(jsless.debug){console[i]("JSLess: "+m)}}else{console[i]("JSLess: "+m)}}}})(k)}function f(i,m){var n=[];i.find(m).each(function(p,o){if(a(o).parentsUntil(i,m).length==0){n.push(o)}});return a(n)}var l=new Date();var c=0;window.jsless=a.extend(true,{debug:false,log:false,logger:h},window.jsless||{});var b={settings:{selector:{target:"self",scope:"widget",latebind:true}},behaviors:{},_methods:{},process:function(i,r,q){if(i.is("script")){return}if(r&&r.debug){jsless.debug=r.debug}if(r){i.data("jsless-options",r)}var s=a.extend(true,{},this.settings,r);var p=new Date();if(!q){c=0;l=p}var o=i;if(!i.attr("data-jsless-widget")){o=i.parents("[data-jsless-widget]").first();if(o.length==0){o=a("body");h.info("declared body as root widget");o.attr("data-jsless-widget","root")}else{h.log("missing data-jsless-widget, treating as a partial")}}var t=o.attr("data-jsless-widget");var m=i.find("[data-jsless-widget]");m=m.filter(function(u){var v=a(this).parentsUntil(i,"[data-jsless-widget]").length==0;return v});var n=i.find("[data-jsless]:not([data-jsless-widget])").addBack("[data-jsless]");n=n.filter(function(u){var v=a(this).parentsUntil(i.parent(),"[data-jsless-widget][data-jsless-widget!="+t+"]").length==0;return v});h.log("found: "+n.length+" elements and "+m.length+" sub widgets ...");n.each(function(x,w){var u=a(w);var v=a.parseJSON(u.attr("data-jsless"));a(v).each(function(z,y){jsless.processBehavior(o,u,y,s)})});m.each(function(w,v){h.log("processing subwidget ...");var u=a(v);jsless.process(u,r,true)});if(!q){h.log("processed: "+c+" behaviors in "+(new Date()-p)+"ms")}o.triggerHandler("jsless-widget-complete");o.trigger("jsless-widget-loaded")},processBehavior:function(m,i,n,p){c++;var o=n.name;if(jsless.behaviors[o]===undefined){if(o=="html"||o=="htmlform"){jsless._methods[o](m,i,n,p)}else{h.error("Behavior not found: "+o);return}}else{jsless.behaviors[o](m,i,n,p)}if(p.debug){h.debug("behavior: "+o+" processed in "+(new Date()-l)+"ms");l=new Date()}}};a.fn.jsless=function(i){return this.each(function(){var m=a(this);jsless.process(m,i)})};if(a.fn.toggleProp===undefined){a.fn.toggleProp=function(i){return this.each(function(){var m=a(this);m.prop(i,!m.prop(i));if(m.is("input[type=checkbox]")&&i=="checked"){setTimeout(function(){m.trigger("change")},0)}})}}h.info("Loading Core...");window.jsless=a.extend(true,b,window.jsless||{});setTimeout(function(){jsless.debug=false},0)}(window.jQuery);/*
 * JSLess Library - AJAX Invoke
 * https://github.com/realstrategos/JSLess
 * *
 * Copyright 2013 OptixConnect LLC and other contributors
 * Released under the Creative Commons Attribution NonCommercial (CC-NC)
 * http://creativecommons.org/licenses/by-nc/3.0/legalcode
 *
 */
!function(a){var e=jsless.logger;var f=function(h){var i=a.extend({},h,{data:a.postify(h.data),traditional:true});if(i.subdomain){i.url=location.protocol+"//"+i.subdomain+"."+location.host+i.url;i.datatype="jsonp"}var g=a.ajax(i);return g};var c=function(h,i){this.invoker=h;this.request=i;this.errormessage=null;this.success=true;if(i.status!=200){this.errormessage=i.status+" Error: "+i.statusText;this.success=false}var g=i.responseText;this.isHTML=true;if(i.responseJSON){this.isHTML=false;g=i.responseJSON}if(!this.isHTML){if(g.d&&Object.keys(g).length==1){g=g.d}}this.data=g};if(!Object.keys){Object.keys=(function(){var j=Object.prototype.hasOwnProperty,i=!({toString:null}).propertyIsEnumerable("toString"),g=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],h=g.length;return function(l){if(typeof l!=="object"&&(typeof l!=="function"||l===null)){throw new TypeError("Object.keys called on non-object")}var n=[],m,k;for(m in l){if(j.call(l,m)){n.push(m)}}if(i){for(k=0;k<h;k++){if(j.call(l,g[k])){n.push(g[k])}}}return n}}())}var d=function(g){this.settings=a.extend({},this.settings,g);if(this.settings.onComplete==null){throw"missing option onComplete"}a(window).bind("invoke-abort",this.Abort);if(this.settings.category){a(window).bind("invoke-abort-"+this.settings.category,this.Abort)}this._Start()};d.prototype={settings:{url:null,category:"normal",datatype:"json",method:"GET",subdomain:null,params:null,onComplete:null,retryCount:0},failCount:0,_request:null,Retry:function(){this.Start()},_Start:function(){var g=function(j,i){this._running=false;if(j.status==401){e.warn("Attempted to access an UnAuthorized Page");a(window).trigger("invoke-authorizationerror",this._request);return}var h=new c(this,j);if(h.errormessage){this.failCount++}this.settings.onComplete(h)};if(this._running){return false}this._running=true;this._request=null;this._request=jsless.transport({url:this.settings.url,type:this.settings.method,dataType:this.settings.datatype,data:this.settings.params,cache:false,complete:a.proxy(g,this)});return true},Abort:function(){this.settings.onComplete=null;this.settings.onFail=null;this._running=false;if(this._request){try{this._request.abort()}catch(g){}}}};a.postify=function(i){var h={};var g=function(k,m){for(var j in k){if(k[j]==null){k[j]=""}var l=isFinite(j)?(m!=""?m:"")+"["+j+"]":(m!=""?m+".":"")+j;switch(typeof(k[j])){case"number":case"string":case"boolean":h[l]=k[j];break;case"object":if(k[j].toUTCString){h[l]=k[j].toUTCString().replace("UTC","GMT")}else{g(k[j],l!=""?l:j)}}}};g(i,"");return h};a.fn.jsless_invoke=function(g){var h=jsless.invoke(g)};var b={invoke:function(h){var g=new d(h);return g},transport:f};e.info("Loading Invoke ...");window.jsless=a.extend(true,b,window.jsless||{})}(window.jQuery);/*
 * JSLess Library - Builtin Methods
 * https://github.com/realstrategos/JSLess
 * *
 * Copyright 2013 OptixConnect LLC and other contributors
 * Released under the Creative Commons Attribution NonCommercial (CC-NC)
 * http://creativecommons.org/licenses/by-nc/3.0/legalcode
 *
 */
!function(a){var c=jsless.logger;var b={settings:{method:{name:null,onSuccess:"widget",onFail:"widget",eventSource:"self",delay:-1,params:{dynamic:{},forms:[]}}},dataMap:function(g,d,e){var j={},f,l,n;for(f in g){l=f in d?d[f]:null;if(e&&l!=null&&typeof l==="object"&&typeof g[f]==="object"&&!(l instanceof jQuery)){l=jsless.dataMap(g[f],l,e)}var m=g[f];var i=j;var h=null;a.each(m.split("."),function(o,p){if(h!=null){i=i[h]}if(i[p]===undefined){i[p]={}}h=p});if(typeof l==="object"){var k=i[h];i[h]=a.extend(true,{},k,l)}else{i[h]=l}}return j},getSelector:function(h,f,d){if(h==null){throw"selector is null"}var e=null;var i={target:null,scope:"widget",latebind:true,mode:"html",getVal:function(){return e}};if(typeof h==="object"&&!(h instanceof jQuery)){a.extend(i,h)}else{i.target=h}var g=function(){var j=null;if(i.scope=="widget"){j=f}else{if(i.scope=="self"){j=d}else{if(i.scope=="document"){j=a(document)}else{if(i.scope=="parents"){j=d.parents()}else{j=a(i.scope)}}}}var k=j;if(i.target!=null){k=j.find(i.target)}if(h=="form"){k=d.parents("form").first()}return k};if(h=="self"){e=d}else{if(h=="widget"){i.mode="replaceWith";e=f}else{if(h=="body"){e=a("body")}else{if(h=="form"){e=d.parents("form").first()}else{if(i.latebind){i.getVal=g}else{e=g()}}}}}return i},compileParams:function(h,e,d){var i=a.extend({},h);if(i.dynamic){var f={};a.each(i.dynamic,function(j,m){var l={name:null,target:m,object:"jQuery",method:"val",methodparams:[]};if(typeof m==="object"&&!(m instanceof jQuery)){a.extend(l,m)}l=jsless.getSelector(l,e,d);var k=l.name||j;f[k]=function(){var n=l.getVal();var o=n;if(l.object!="jQuery"){o=window[l.object]}var p=o[l.method].apply(n,l.methodparams);return p}});i.dynamic=f}if(i.forms){var g=[];a.each(i.forms,function(k,l){var j=jsless.getSelector(l,e,d);g.push(j)});i.forms=g}return i},getParams:function(d){var g=a.extend({},d);var e={};if(g.dynamic){a.each(g.dynamic,function(j,m){var l=e;var k=null;a.each(j.split("."),function(n,o){if(k!=null){l=l[k]}if(l[o]===undefined){l[o]={}}k=o});l[k]=m()});delete g.dynamic}var f={};if(g.forms){a.each(g.forms,function(m,k){var j=k.getVal();var l=jsless.processContainer(j);a.extend(f,l)});delete g.forms}var i={};a.each(g,function(j,l){var k=j;if(j.indexOf("_dynamic")>0||j.indexOf("_forms")>0){k=j.substr(1)}i[k]=l});var h=a.extend(true,{},f,i,e);return h},getValue:function(d,f,e){if(d.attr("contenteditable")!=null){f[e]=d.html()}else{if(d.is("select[multiple] option:selected")){f[e]=f[e]||[];f[e].push(d.val())}else{if(d.is("input[data-list]:checkbox")){f[e]=f[e]||[];if(d.is(":checked")){f[e].push(d.val())}}else{if(d.is("input[data-type='enum']:checkbox")){if(d.is(":checked")){var g=f[e]||"";if(g.length>0){g+=", "}g+=d.val();f[e]=g}}else{if(d.is("input[data-list]")){f[e]=f[e]||[];f[e].push(d.val())}else{if(d.is("input:checkbox,input:radio")){if(d.is("input[value]")){if(d.is(":checked")){f[e]=d.val()}}else{f[e]=d.is(":checked");if(f[e]=="on"){f[e]=true}}}else{if(d.is("option:selected")){f[e]=d.val()}else{if(d.is("select")){d.find("option:selected").each(function(h,i){f=jsless.getValue(a(i),f,e)})}else{f[e]=d.val()}}}}}}}}return f},processContainer:function(e){var h="[name],[data-list],[data-index]";var j="input[type!='button'][type!='submit'],select,textarea,[contenteditable]";var f=e.find(h+","+j).filter(function(k){var l=a(this).parentsUntil(e,h).length==0;return l});var g=f.filter(j);var d=f.not(g);var i={};a.each(g,function(m,l){var k=a(l);var n=k.attr("name");if(k.attr("data-list")){n=k.attr("data-list")}else{if(k.attr("data-index")!=null){n+="["+k.attr("data-index")+"]"}}if(n==null){c.warn("element has no name: "+k[0].outerHTML);return}var o=jsless.getValue(k,i,n);i=o});a.each(d,function(m,l){var k=a(l);var o=jsless.processContainer(k);if(k.attr("data-list")!=null){var n=k.attr("data-list");i[n]=i[n]||[];if(!jQuery.isEmptyObject(o)){i[n].push(o)}}else{var n=k.attr("name");if(k.attr("data-index")!=null){n+="["+k.attr("data-index")+"]"}i[n]=o}});return i},_methods:{html:function(f,d,g,k){var l=a.extend(true,{},jsless.settings.method,k.method,{name:"html",url:null,method:"GET",event:"click",stopEventPropagation:false,onSuccess:"widget",onFail:null,params:{dynamic:{},forms:[]}},g);if(!l.url){c.error("html url not specified: "+JSON.stringify(l))}if(!l.onFail){l.onFail=l.onSuccess}var e=jsless.getSelector(l.eventSource,f,d).getVal();var m=jsless.getSelector(l.onSuccess,f,d);var i=jsless.getSelector(l.onFail,f,d);var h=jsless.compileParams(l.params,f,d);var j=function(n,o){l.eventData=o;jsless._methods.htmlevent(n,f,d,l,m,i,h,k)};if(l.event=="load"){f.one("jsless-widget-complete",j)}else{e.bind(l.event,j)}},htmlevent:function(j,g,d,q,s,l,i,n){var m="";c.debug(q.name+" event:"+q.event+"\r\n\t :: "+m);if(q.stopEventPropagation&&q.event!="load"){j.preventDefault()}var o=jsless.getParams(i);var f=s.getVal();var e=l.getVal();if(q.eventDataMap&&q.eventData){var k=jsless.dataMap(q.eventDataMap,q.eventData);a.extend(o,k)}var p=d.triggerHandler("jsless-"+q.name+"-begin",[i]);if(p===undefined||p){d.trigger("jsless-ajax-begin");var h={url:q.url,category:"normal",datatype:"json",method:q.method,subdomain:null,params:o,onComplete:function(v){v.success=v.success&&v.isHTML;var t=a(v.data);var w=jsless.processContainer(t.find("[data-jsless-params]"));if(t.attr("data-jsless-error")){v.success=false;v.errormessage=t.attr("data-jsless-error")}var x=s;var u=f;if(!v.success){x=l;u=e;d.trigger("jsless-ajax-beforefail");u.triggerHandler("jsless-"+q.name+"-beforefail",[w])}else{d.trigger("jsless-ajax-beforesuccess");u.triggerHandler("jsless-"+q.name+"-beforesuccess",[w])}d.trigger("jsless-ajax-beforecomplete");u.triggerHandler("jsless-"+q.name+"-beforecomplete",[w]);setTimeout(function(){a.each(u,function(B,A){var z=a(A);var y=t.clone();z[x.mode](y);y.jsless(n)});setTimeout(function(){if(v.success){d.trigger("jsless-ajax-success");u.triggerHandler("jsless-"+q.name+"-success",[w])}else{d.trigger("jsless-ajax-fail");u.triggerHandler("jsless-"+q.name+"-fail",[w])}d.trigger("jsless-ajax-complete");u.triggerHandler("jsless-"+q.name+"-complete",[w])},0)},0)},retryCount:0};var r=function(){if(f.parents("body").length==0){c.debug(q.name+" event:"+q.event+"\r\n\t :: $success is detached");return}jsless.invoke(h)};if(q.delay<0){r()}else{setTimeout(r,q.delay)}}},htmlform:function(f,d,g,h){var i=a.extend(true,{},jsless.settings.method,h.method,{name:"html",url:null,method:"GET",event:d.is("form")?"submit":"click",stopEventPropagation:d.is("form"),onSuccess:"widget",onFail:null,params:{dynamic:{},forms:[]}},g);if(i.params.forms.length==0){if(d.is("form")){c.log("element is form");i.params.forms.push(d)}else{var e=d.parentsUntil(f,"form");if(e.length==1){c.log("element is within form")}else{c.log("element is formless");e=d}i.params.forms.push(e)}}jsless._methods.html(f,d,i,h)}}};c.info("Loading Methods ...");window.jsless=a.extend(true,b,window.jsless||{})}(window.jQuery);/*
 * JSLess Library - Builtin Behaviors
 * https://github.com/realstrategos/JSLess
 * *
 * Copyright 2013 OptixConnect LLC and other contributors
 * Released under the Creative Commons Attribution NonCommercial (CC-NC)
 * http://creativecommons.org/licenses/by-nc/3.0/legalcode
 *
 */
!function(a){var c=jsless.logger;var b={settings:{behavior:{name:null,event:"click",eventSource:"self",target:"self",delay:-1,params:[],dynamic:[],stopEventPropagation:false}},behaviors:{execute:function(f,d,g,j){var k=a.extend(true,{},jsless.settings.behavior,j.behavior,{name:"execute",object:"jQuery",method:null},g);if(!k.method){c.error("execute method not specified: "+JSON.stringify(k))}var h={};a.each(k.dynamic,function(n,o){if(k.dynamic[n]==null){return}var m=jsless.compileParams({dynamic:k.dynamic[n]},f,d);h[n]=m});var e=jsless.getSelector(k.eventSource,f,d).getVal();var l=jsless.getSelector(k.target,f,d);var i=function(o,p){var q=k.params.slice(0);if(k.stopEventPropagation){o.stopPropagation()}c.debug(k.name+" event:"+k.event+" method: "+k.method+"\r\n\t :: "+JSON.stringify(k));var r=d.triggerHandler("jsless-"+k.name+"-begin");if(r===undefined||r){var m=l.getVal();a.each(h,function(s,t){var u=jsless.getParams(h[s]);if(typeof u==="object"){a.extend(true,q,u)}else{q[s]=u}});var n=function(){d.triggerHandler("jsless-"+k.name+"-beforecomplete");var t=m;var s=m[k.method];a.each(q,function(v,w){if(q[v]=="@event"){q[v]=o}if(q[v]=="@eventData"){q[v]=p}if(q[v]=="@target"){q[v]=m}});if(k.object!="jQuery"){var t=window;a.each(k.object.split("."),function(v,w){t=t[w]});var s=t[k.method]}var u=s.apply(t,q);d.triggerHandler("jsless-"+k.name+"-complete")};if(k.delay<0){n()}else{setTimeout(n,k.delay)}}};if(k.event=="load"){f.one("jsless-widget-complete",i)}else{e.bind(k.event,i)}},keyclick:function(f,d,g,h){var j=a.extend(true,{},jsless.settings.behavior,h.behavior,{name:"keyclick",event:"keydown",target:"self",keycode:13},g);var i=j.params;var e=jsless.getSelector(j.eventSource,f,d).getVal();var k=jsless.getSelector(j.target,f,d);e.bind(j.event,function(n){c.debug(j.name+" event:"+j.event+"\r\n\t :: "+JSON.stringify(j));var o=d.triggerHandler("jsless-"+j.name+"-begin");if(o===undefined||o){var m=(n.keyCode?n.keyCode:n.which);if(m==j.keycode){n.preventDefault();var l=k.getVal();l.triggerHandler("click")}}})},toggleClass:function(f,d,g,h){var j=a.extend(true,{},jsless.settings.behavior,h.behavior,{name:"toggleClass",className:null},g);if(!j.className){c.error("className not specified: "+JSON.stringify(j))}var i=j.params;var e=jsless.getSelector(j.eventSource,f,d).getVal();var k=jsless.getSelector(j.target,f,d);e.bind(j.event,function(o){c.debug(j.name+" event:"+j.event+"\r\n\t :: "+JSON.stringify(j));var p=d.triggerHandler("jsless-"+j.name+"-begin");if(p===undefined||p){var m=k.getVal();var l=a(o.target).parents(j.target).addBack(j.target).first();var n=j.className;m.removeClass(n);l.addClass(n)}})},parentTrigger:function(f,d,g,i){var j=a.extend(true,{},jsless.settings.behavior,i.method,{name:"parentTrigger",eventSource:"widget",parentSelector:"[data-jsless-widget]",parentEvent:"jsless-reload",level:1},g);var e=jsless.getSelector(j.eventSource,f,d).getVal();var h=function(l,m){var k=e;if(j.level>0){k=a(k.parents(j.parentSelector)[j.level-1])}k.triggerHandler(j.parentEvent,m)};if(j.event=="load"){f.one("jsless-widget-complete",h)}else{e.bind(j.event,h)}}}};c.info("Loading Behaviors ...");window.jsless=a.extend(true,b,window.jsless||{})}(window.jQuery);