/*
 * JSLess Library - Core
 * https://github.com/realstrategos/JSLess
 * *
 * Copyright 2013 OptixConnect LLC and other contributors
 * Released under the Creative Commons Attribution NonCommercial (CC-NC)
 * http://creativecommons.org/licenses/by-nc/3.0/legalcode
 *
 */
!function(a){window.console=window.console||{log:function(){},error:function(j){alert(j)},info:function(){},warn:function(){},debug:function(){}};var f=["log","error","warn","debug","info"];var e={};for(var d in f){var h=f[d];e[h]=(function(j){return function(k){if(jsless.log&&j=="log"){window.console[j]("JSLess: "+k)}else{if(jsless.debug&&j=="debug"){window.console[j]("JSLess: "+k)}else{window.console[j]("JSLess: "+k)}}}})(h)}function g(j,k){var l=[];j.find(k).each(function(n,m){if(a(m).parentsUntil(j,k).length==0){l.push(m)}});return a(l)}var i=new Date();var c=0;window.jsless=a.extend(true,{debug:true,log:false,console:e},window.jsless||{});var b={settings:{selector:{target:"self",scope:"widget",latebind:true}},behaviors:{},_methods:{},process:function(j,p,o){if(j.is("script")){return}if(p&&p.debug){jsless.debug=p.debug}var q=a.extend(true,{},this.settings,p);var n=new Date();if(!o){c=0;i=n}var m=j;if(!j.attr("data-jsless-widget")){m=j.parents("[data-jsless-widget]").first();if(m.length==0){m=a("body");e.info("declared body as root widget");m.attr("data-jsless-widget","root")}else{e.log("missing data-jsless-widget, treating as a partial")}}var k=j.find("[data-jsless-widget]");k=k.filter(function(r){var s=a(this).parentsUntil(j,"[data-jsless-widget]").length==0;return s});var l=j.find("[data-jsless]").addBack("[data-jsless]");l=l.filter(function(r){var s=a(this).parentsUntil(j.parent(),"[data-jsless-widget]").length<=1;return s});e.log("found: "+l.length+" elements and "+k.length+" sub widgets ...");l.each(function(u,t){var r=a(t);var s=a.parseJSON(r.attr("data-jsless"));a(s).each(function(w,v){jsless.processBehavior(m,r,v,q)})});k.each(function(t,s){e.log("processing subwidget ...");var r=a(s);jsless.process(r,p,true)});if(!o){e.log("processed: "+c+" behaviors in "+(new Date()-n)+"ms")}m.triggerHandler("jsless-widget-complete");m.trigger("jsless-widget-loaded")},processBehavior:function(k,j,l,n){c++;var m=l.name;if(jsless.behaviors[m]===undefined){if(m=="html"||m=="htmlform"){jsless._methods[m](k,j,l,n)}else{e.error("Behavior not found: "+m);return}}else{jsless.behaviors[m](k,j,l,n)}if(n.debug){e.log("behavior: "+m+" processed in "+(new Date()-i)+"ms");i=new Date()}}};a.fn.jsless=function(j){return this.each(function(){var k=a(this);jsless.process(k,j)})};if(a.fn.toggleProp===undefined){a.fn.toggleProp=function(j){return this.each(function(){var k=a(this);k.prop(j,!k.prop(j))})}}e.info("Loading Core...");window.jsless=a.extend(true,b,window.jsless||{});setTimeout(function(){jsless.debug=false},0)}(window.jQuery);/*
 * JSLess Library - AJAX Invoke
 * https://github.com/realstrategos/JSLess
 * *
 * Copyright 2013 OptixConnect LLC and other contributors
 * Released under the Creative Commons Attribution NonCommercial (CC-NC)
 * http://creativecommons.org/licenses/by-nc/3.0/legalcode
 *
 */
!function(a){var d=jsless.console;var c=function(h,i){this.invoker=h;this.request=i;this.errormessage=null;this.success=true;if(i.status!=200){this.errormessage=i.status+" Error: "+i.statusText;this.success=false}var g=i.responseText;this.isHTML=typeof g!="object";if(!this.isHTML){g=e(g);if(g.d){g=g.d}}this.data=g};var e=function(i){if(i===null){return i}if(typeof i==="string"){var j=/\/Date\(\d+\)\//;var g=i.match(j);if(!g){return i}var g=g[0].match(/\d+/);var h=parseInt(g[0]);return new Date(h)}if(typeof i!=="object"){return i}var k=a.proxy(e,this);a.each(i,function(l,m){i[l]=k(m)});return i};var f=function(g){this.settings=a.extend({},this.settings,g);if(this.settings.onComplete==null){throw"missing option onComplete"}a(window).bind("invoke-abort",this.Abort);if(this.settings.category){a(window).bind("invoke-abort-"+this.settings.category,this.Abort)}this._Start()};f.prototype={settings:{url:null,category:"normal",datatype:"json",method:"GET",subdomain:null,params:null,onComplete:null,retryCount:0},failCount:0,_request:null,Retry:function(){this.Start()},_Start:function(){var g=function(p,o){this._running=false;if(p.status==401){d.warn("Attempted to access an UnAuthorized Page");a(window).trigger("invoke-authorizationerror",this._request);return}var n=new c(this,p);if(n.errormessage){this.failCount++}this.settings.onComplete(n)};if(this._running){return false}this._running=true;this._request=null;var m=this.settings.url;var l=this.settings.method;var i=this.settings.params;var j=this.settings.datatype;if(this.settings.subdomain){m=location.protocol+"//"+subDomain+"."+location.host+m;j="jsonp"}var k=a.postify(i);var h="application/json; charset=utf-8";this._request=a.ajax({url:m,type:l,dataType:j,data:k,cache:false,traditional:true,complete:a.proxy(g,this)});return true},Abort:function(){this.settings.onComplete=null;this.settings.onFail=null;this._running=false;if(this._request){try{this._request.abort()}catch(g){}}}};a.postify=function(i){var h={};var g=function(k,m){for(var j in k){if(k[j]==null){k[j]=""}var l=isFinite(j)?(m!=""?m:"")+"["+j+"]":(m!=""?m+".":"")+j;switch(typeof(k[j])){case"number":case"string":case"boolean":h[l]=k[j];break;case"object":if(k[j].toUTCString){h[l]=k[j].toUTCString().replace("UTC","GMT")}else{g(k[j],l!=""?l:j)}}}};g(i,"");return h};a.fn.jsless_invoke=function(g){var h=jsless.invoke(g)};var b={invoke:function(h){var g=new f(h);return g}};d.info("Loading Invoke ...");window.jsless=a.extend(true,b,window.jsless||{})}(window.jQuery);/*
 * JSLess Library - Builtin Methods
 * https://github.com/realstrategos/JSLess
 * *
 * Copyright 2013 OptixConnect LLC and other contributors
 * Released under the Creative Commons Attribution NonCommercial (CC-NC)
 * http://creativecommons.org/licenses/by-nc/3.0/legalcode
 *
 */
!function(a){var c=jsless.console;var b={settings:{method:{name:null,onSuccess:"widget",onFail:"widget",params:{dynamic:{},forms:[]}}},getSelector:function(h,f,d){if(h==null){throw"selector is null"}var e=null;var i={target:null,scope:"widget",latebind:true,mode:"html",getVal:function(){return e}};if(typeof h==="object"&&!(h instanceof jQuery)){a.extend(i,h)}else{i.target=h}var g=function(){var j=null;if(i.scope=="widget"){j=f}else{if(i.scope=="self"){j=d}else{if(i.scope=="document"){j=a(document)}else{j=a(i.scope)}}}var k=j;if(i.target!=null){k=j.find(i.target)}return k};if(h=="self"){e=d}else{if(h=="widget"){i.mode="replaceWith";e=f}else{if(i.latebind){i.getVal=g}else{e=g()}}}return i},compileParams:function(h,e,d){var i=a.extend({},h);if(i.dynamic){var f={};a.each(i.dynamic,function(j,l){var k={target:l,object:"jQuery",method:"val",methodparams:[]};if(typeof l==="object"&&!(l instanceof jQuery)){a.extend(k,l)}k=jsless.getSelector(k,e,d);f[j]=function(){var m=k.getVal();var n=m;if(k.object!="jQuery"){n=window[k.object]}var o=n[k.method].apply(m,k.methodparams);return o}});i.dynamic=f}if(i.forms){var g=[];a.each(i.forms,function(k,l){var j=jsless.getSelector(l,e,d);g.push(j)});i.forms=g}return i},getParams:function(d){var g=a.extend({},d);var e={};if(g.dynamic){a.each(g.dynamic,function(j,m){var l=e;var k=j;a.each(j.split("."),function(n,o){if(n==0){return true}if(l[k]===undefined){l[k]={}}l=l[k];k=o});l[k]=m()});delete g.dynamic}var f={};if(g.forms){a.each(g.forms,function(m,k){var j=k.getVal();var l=jsless.processContainer(j);a.extend(f,l)});delete g.forms}var i={};a.each(g,function(j,l){var k=j;if(j.indexOf("_dynamic")>0||j.indexOf("_forms")>0){k=j.substr(1)}i[k]=l});var h=a.extend(true,{},f,e,i);return h},getValue:function(d,f,e){if(d.attr("contenteditiable")!=null){f[e]=d.html()}else{if(d.is("select[multiple] option:selected")){f[e]=f[e]||[];f[e].push(d.val())}else{if(d.is("input[data-list]:checkbox")){f[e]=f[e]||[];if(d.is(":checked")){f[e].push(d.val())}}else{if(d.is("input:checkbox,input:radio")){if(d.is("input[value]")){if(d.is(":checked")){f[e]=d.val()}}else{f[e]=d.is(":checked")}}else{if(d.is("option:selected")){f[e]=d.val()}else{if(d.is("select")){d.find("option:selected").each(function(g,h){f=jsless.getValue(a(h),f,e)})}else{f[e]=d.val()}}}}}}return f},processContainer:function(e){var h="[name],[data-list]";var j="input[type!='button'][type!='submit'],select,textarea,[contenteditable]";var f=e.find(h+","+j).filter(function(k){var l=a(this).parentsUntil(e,h).length==0;return l});var g=f.filter(j);var d=f.not(g);var i={};a.each(g,function(m,l){var k=a(l);var n=k.attr("name");if(k.attr("data-list")){n=k.attr("data-list")}else{if(k.attr("data-index")!=null){n+="["+k.attr("data-index")+"]"}}if(n==null){c.warn("element has no name: "+k[0].outerHTML);return}var o=jsless.getValue(k,i,n);i=o});a.each(d,function(m,l){var k=a(l);var o=jsless.processContainer(k);if(k.attr("data-list")!=null){var n=k.attr("data-list");i[n]=i[n]||[];i[n].push(o)}else{var n=k.attr("name");if(k.attr("data-index")!=null){n+="["+k.attr("data-index")+"]"}i[n]=o}});return i},_methods:{html:function(e,d,f,j){var k=a.extend(true,{},jsless.settings.method,j.method,{name:"html",url:null,method:"GET",event:"click",eventstop:false,onSuccess:"widget",onFail:null,params:{dynamic:{},forms:[]}},f);if(!k.url){c.error("html url not specified: "+JSON.stringify(k))}if(!k.onFail){k.onFail=k.onSuccess}var l=jsless.getSelector(k.onSuccess,e,d);var h=jsless.getSelector(k.onFail,e,d);var g=jsless.compileParams(k.params,e,d);var i=function(m){jsless._methods.htmlevent(m,e,d,k,l,h,g,j)};if(k.event=="load"){e.one("jsless-widget-complete",i)}else{d.bind(k.event,i)}},htmlevent:function(i,g,d,n,o,j,h,k){c.debug(n.name+" event:"+n.event);if(n.eventstop&&n.event!="load"){i.preventDefault()}var l=jsless.getParams(h);var f=o.getVal();var e=j.getVal();var m=d.triggerHandler("jsless-"+n.name+"-begin");if(m===undefined||m){d.trigger("jsless-ajax-begin");jsless.invoke({url:n.url,category:"normal",datatype:"json",method:n.method,subdomain:null,params:l,onComplete:function(r){r.success=r.success&&r.isHTML;var p=a(r.data);if(p.attr("data-jsless-error")){r.success=false;r.errormessage=p.attr("data-jsless-error")}var s=o;var q=f;if(!r.success){s=j;q=e;d.trigger("jsless-ajax-beforefail");q.triggerHandler("jsless-"+n.name+"-beforefail")}else{d.trigger("jsless-ajax-beforesuccess");q.triggerHandler("jsless-"+n.name+"-beforesuccess")}d.trigger("jsless-ajax-beforecomplete");q.triggerHandler("jsless-"+n.name+"-beforecomplete");a.each(q,function(w,v){var u=a(v);var t=p.clone();u[s.mode](t);t.jsless(k)});if(r.success){d.trigger("jsless-ajax-success");q.triggerHandler("jsless-"+n.name+"-success")}else{d.trigger("jsless-ajax-fail");q.triggerHandler("jsless-"+n.name+"-fail")}d.trigger("jsless-ajax-complete");q.triggerHandler("jsless-"+n.name+"-complete")},retryCount:0})}},htmlform:function(f,d,g,h){var i=a.extend(true,{},jsless.settings.method,h.method,{name:"html",url:null,method:"GET",event:d.is("form")?"submit":"click",eventstop:d.is("form"),onSuccess:"widget",onFail:null,params:{dynamic:{},forms:[]}},g);if(i.params.forms.length==0){if(d.is("form")){c.log("element is form");i.params.forms.push(d)}else{var e=d.parentsUntil(f,"form");if(e.length==1){c.log("element is within form")}else{c.log("element is formless");e=d}i.params.forms.push(e)}}jsless._methods.html(f,d,i,h)}}};c.info("Loading Methods ...");window.jsless=a.extend(true,b,window.jsless||{})}(window.jQuery);/*
 * JSLess Library - Builtin Behaviors
 * https://github.com/realstrategos/JSLess
 * *
 * Copyright 2013 OptixConnect LLC and other contributors
 * Released under the Creative Commons Attribution NonCommercial (CC-NC)
 * http://creativecommons.org/licenses/by-nc/3.0/legalcode
 *
 */
!function(a){var c=jsless.console;var b={settings:{behavior:{name:null,event:"click",eventSource:"self",target:"self",delay:-1,params:[],dynamic:[],stopEventPropagation:false}},behaviors:{execute:function(f,d,g,j){var l=a.extend(true,{},jsless.settings.behavior,j.behavior,{name:"execute",object:"jQuery",method:null},g);if(!l.method){c.error("execute method not specified: "+JSON.stringify(l))}var k=a.extend({},l.params);var h=jsless.compileParams(l.dynamic,f,d);var e=jsless.getSelector(l.eventSource,f,d).getVal();var m=jsless.getSelector(l.target,f,d);var i=function(q){if(l.stopEventPropagation){q.stopPropagation()}c.debug(l.name+" event:"+l.event+" method: "+l.method+"\r\n\t :: "+JSON.stringify(l));var r=d.triggerHandler("jsless-"+l.name+"-begin");if(r===undefined||r){var n=m.getVal();var p=jsless.getParams(h);a.each(p,function(s,t){if(typeof p[s]==="object"){a.extend(true,k[s],p[s])}else{k[s]=p[s]}});var o=function(){d.triggerHandler("jsless-"+l.name+"-beforecomplete");var t=n;var s=n[l.method];a.each(k,function(v,w){if(k[v]=="@event"){k[v]=q}if(k[v]=="@target"){k[v]=n}});if(l.object!="jQuery"){var t=window;a.each(l.object.split("."),function(v,w){t=t[w]});var s=t[l.method]}var u=s.apply(t,k);d.triggerHandler("jsless-"+l.name+"-complete")};if(l.delay<0){o()}else{setTimeout(o,l.delay)}}};if(l.event=="load"){f.one("jsless-widget-complete",i)}else{d.bind(l.event,i)}},keyclick:function(f,d,g,h){var j=a.extend(true,jsless.settings.behavior,h.behavior,{name:"keyclick",event:"keydown",target:"self",keycode:13},g);var i=j.params;var e=jsless.getSelector(j.eventSource,f,d).getVal();var k=jsless.getSelector(j.target,f,d);e.bind(j.event,function(n){c.debug(j.name+" event:"+j.event+"\r\n\t :: "+JSON.stringify(j));var o=d.triggerHandler("jsless-"+j.name+"-begin");if(o===undefined||o){var m=(n.keyCode?n.keyCode:n.which);if(m==j.keycode){n.preventDefault();var l=k.getVal();l.triggerHandler("click")}}})},toggleClass:function(f,d,g,h){var j=a.extend(true,jsless.settings.behavior,h.behavior,{name:"toggleClass",className:null},g);if(!j.className){c.error("className not specified: "+JSON.stringify(j))}var i=j.params;var e=jsless.getSelector(j.eventSource,f,d).getVal();var k=jsless.getSelector(j.target,f,d);e.bind(j.event,function(o){c.debug(j.name+" event:"+j.event+"\r\n\t :: "+JSON.stringify(j));var p=d.triggerHandler("jsless-"+j.name+"-begin");if(p===undefined||p){var m=k.getVal();var l=a(o.target).parents(j.target).addBack(j.target).first();var n=j.className;m.removeClass(n);l.addClass(n)}})}}};c.info("Loading Behaviors ...");window.jsless=a.extend(true,b,window.jsless||{})}(window.jQuery);