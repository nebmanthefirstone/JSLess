/*
 * JSLess Library - Core
 * https://github.com/realstrategos/JSLess
 * *
 * Copyright 2013 OptixConnect LLC and other contributors
 * Released under the Creative Commons Attribution NonCommercial (CC-NC)
 * http://creativecommons.org/licenses/by-nc/3.0/legalcode
 *
 */
!function($){if(!window.console){window.console={}}var m=["log","info","warn","error","debug","trace","dir","group","groupCollapsed","groupEnd","time","timeEnd","profile","profileEnd","dirxml","assert","count","markTimeline","timeStamp","clear"];for(var i=0;i<m.length;i++){if(!window.console[m[i]]){if(m[i]=="error"){window.console[m[i]]=function(e){alert(e)}}window.console[m[i]]=function(){}}}var logger={};var consoleMethods=["log","error","warn","debug","info"];for(var cm in consoleMethods){var method=consoleMethods[cm];logger[method]=(function(method){return function(message){if(method=="log"){if(jsless.log){console[method]("JSLess: "+message)}}else{if(method=="debug"){if(jsless.debug){console[method]("JSLess: "+message)}}else{console[method]("JSLess: "+message)}}}})(method)}function getSubWidgets($source,filter){var xElements=[];$source.find(filter).each(function(i,el){if($(el).parentsUntil($source,filter).length==0){xElements.push(el)}});return $(xElements)}var startTimer=new Date();var behaviorCounter=0;window.jsless=$.extend(true,{debug:false,log:false,logger:logger},window.jsless||{});var _jsless={settings:{selector:{target:"self",scope:"widget",latebind:true}},behaviors:{},_methods:{},process:function($element,options,isSubWidget){if($element.is("script")){return}if(options&&options.debug){jsless.debug=options.debug}if(options){$element.data("jsless-options",options)}var settings=$.extend(true,{},this.settings,options);var initTimer=new Date();if(!isSubWidget){behaviorCounter=0;startTimer=initTimer}var $widget=$element;if(!$element.attr("data-jsless-widget")){$widget=$element.parents("[data-jsless-widget]").first();if($widget.length==0){$widget=$("body");logger.info("declared body as root widget");$widget.attr("data-jsless-widget","root")}else{logger.log("missing data-jsless-widget, treating as a partial")}}var widgetID=$widget.attr("data-jsless-widget");var $subWidgets=$element.find("[data-jsless-widget]");$subWidgets=$subWidgets.filter(function(index){var temp=$(this).parentsUntil($element,"[data-jsless-widget]").length==0;return temp});var $targets=$element.find("[data-jsless]:not([data-jsless-widget])").addBack("[data-jsless]");$targets=$targets.filter(function(index){var temp=$(this).parentsUntil($element.parent(),"[data-jsless-widget][data-jsless-widget!="+widgetID+"]").length==0;return temp});logger.log("found: "+$targets.length+" elements and "+$subWidgets.length+" sub widgets ...");$targets.each(function(tIndex,target){var $target=$(target);var rawBehavior=$target.attr("data-jsless");var behaviors=[];if(rawBehavior.indexOf('[{"')==0){behaviors=$.parseJSON(rawBehavior)}else{var checkMe=eval(rawBehavior);if(Object.prototype.toString.call(checkMe)==="[object Array]"){behaviors=checkMe}}$(behaviors).each(function(index,behavior){jsless.processBehavior($widget,$target,behavior,settings)})});$subWidgets.each(function(tIndex,target){logger.log("processing subwidget ...");var $target=$(target);jsless.process($target,options,true)});if(!isSubWidget){logger.log("processed: "+behaviorCounter+" behaviors in "+(new Date()-initTimer)+"ms")}$widget.triggerHandler("jsless-widget-complete");$widget.trigger("jsless-widget-loaded")},processBehavior:function($widget,$element,behavior,settings){behaviorCounter++;var name=behavior.name;if(jsless.behaviors[name]===undefined){if(name=="html"||name=="htmlform"){jsless._methods[name]($widget,$element,behavior,settings)}else{logger.error("Behavior not found: "+name);return}}else{jsless.behaviors[name]($widget,$element,behavior,settings)}if(settings.debug){logger.debug("behavior: "+name+" processed in "+(new Date()-startTimer)+"ms");startTimer=new Date()}}};$.fn.jsless=function(options){return this.each(function(){var $this=$(this);jsless.process($this,options)})};if($.fn.toggleProp===undefined){$.fn.toggleProp=function(propName){return this.each(function(){var $this=$(this);$this.prop(propName,!$this.prop(propName));if($this.is("input[type=checkbox]")&&propName=="checked"){setTimeout(function(){$this.trigger("change")},0)}})}}logger.info("Loading Core...");window.jsless=$.extend(true,_jsless,window.jsless||{});setTimeout(function(){jsless.debug=false},0)}(window.jQuery);/*
 * JSLess Library - AJAX Invoke
 * https://github.com/realstrategos/JSLess
 * *
 * Copyright 2013 OptixConnect LLC and other contributors
 * Released under the Creative Commons Attribution NonCommercial (CC-NC)
 * http://creativecommons.org/licenses/by-nc/3.0/legalcode
 *
 */
!function(a){var e=jsless.logger;var f=function(h){var i=a.extend({},h,{data:a.postify(h.data),traditional:true});if(i.subdomain){i.url=location.protocol+"//"+i.subdomain+"."+location.host+i.url;i.datatype="jsonp"}var g=a.ajax(i);return g};var c=function(h,i){this.invoker=h;this.request=i;this.errormessage=null;this.success=true;if(i.status!=200){this.errormessage=i.status+" Error: "+i.statusText;this.success=false}var g=i.responseText;this.isHTML=true;if(i.responseJSON){this.isHTML=false;g=i.responseJSON}if(!this.isHTML){if(g.d&&Object.keys(g).length==1){g=g.d}}this.data=g};if(!Object.keys){Object.keys=(function(){var j=Object.prototype.hasOwnProperty,i=!({toString:null}).propertyIsEnumerable("toString"),g=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],h=g.length;return function(l){if(typeof l!=="object"&&(typeof l!=="function"||l===null)){throw new TypeError("Object.keys called on non-object")}var n=[],m,k;for(m in l){if(j.call(l,m)){n.push(m)}}if(i){for(k=0;k<h;k++){if(j.call(l,g[k])){n.push(g[k])}}}return n}}())}var d=function(g){this.settings=a.extend({},this.settings,g);if(this.settings.onComplete==null){throw"missing option onComplete"}a(window).bind("invoke-abort",this.Abort);if(this.settings.category){a(window).bind("invoke-abort-"+this.settings.category,this.Abort)}this._Start()};d.prototype={settings:{url:null,category:"normal",datatype:"json",method:"GET",subdomain:null,params:null,onComplete:null,retryCount:0},failCount:0,_request:null,Retry:function(){this.Start()},_Start:function(){var g=function(j,i){this._running=false;if(j.status==401){e.warn("Attempted to access an UnAuthorized Page");a(window).trigger("invoke-authorizationerror",this._request);return}var h=new c(this,j);if(h.errormessage){this.failCount++}this.settings.onComplete(h)};if(this._running){return false}this._running=true;this._request=null;this._request=jsless.transport({url:this.settings.url,type:this.settings.method,dataType:this.settings.datatype,data:this.settings.params,cache:false,complete:a.proxy(g,this)});return true},Abort:function(){this.settings.onComplete=null;this.settings.onFail=null;this._running=false;if(this._request){try{this._request.abort()}catch(g){}}}};a.postify=function(i){var h={};var g=function(k,m){for(var j in k){if(k[j]==null){k[j]=""}var l=isFinite(j)?(m!=""?m:"")+"["+j+"]":(m!=""?m+".":"")+j;switch(typeof(k[j])){case"number":case"string":case"boolean":h[l]=k[j];break;case"object":if(k[j].toUTCString){h[l]=k[j].toUTCString().replace("UTC","GMT")}else{g(k[j],l!=""?l:j)}}}};g(i,"");return h};a.fn.jsless_invoke=function(g){var h=jsless.invoke(g)};var b={invoke:function(h){var g=new d(h);return g},transport:f};e.info("Loading Invoke ...");window.jsless=a.extend(true,b,window.jsless||{})}(window.jQuery);/*
 * JSLess Library - Builtin Methods
 * https://github.com/realstrategos/JSLess
 * *
 * Copyright 2013 OptixConnect LLC and other contributors
 * Released under the Creative Commons Attribution NonCommercial (CC-NC)
 * http://creativecommons.org/licenses/by-nc/3.0/legalcode
 *
 */
!function(a){var c=jsless.logger;var b={settings:{method:{name:null,onSuccess:"widget",onFail:"widget",eventSource:"self",delay:-1,params:{dynamic:{},forms:[]}}},dataMap:function(g,d,e){var j={},f,l,n;for(f in g){l=f in d?d[f]:null;if(e&&l!=null&&typeof l==="object"&&typeof g[f]==="object"&&!(l instanceof jQuery)){l=jsless.dataMap(g[f],l,e)}var m=g[f];var i=j;var h=null;a.each(m.split("."),function(o,p){if(h!=null){i=i[h]}if(i[p]===undefined){i[p]={}}h=p});if(typeof l==="object"){var k=i[h];i[h]=a.extend(true,{},k,l)}else{i[h]=l}}return j},getSelector:function(h,f,d){if(h==null){throw"selector is null"}var e=null;var i={target:null,scope:"widget",latebind:true,mode:"html",getVal:function(){return e}};if(typeof h==="object"&&!(h instanceof jQuery)){a.extend(i,h)}else{i.target=h}var g=function(){var j=null;if(i.scope=="widget"){j=f}else{if(i.scope=="self"){j=d}else{if(i.scope=="document"){j=a(document)}else{if(i.scope=="parents"){j=d.parents()}else{j=a(i.scope)}}}}var k=j;if(i.target!=null){k=j.find(i.target)}if(h=="form"){k=d.parents("form").first()}return k};if(h=="self"){e=d}else{if(h=="widget"){i.mode="replaceWith";e=f}else{if(h=="body"){e=a("body")}else{if(h=="document"){e=a(document)}else{if(h=="window"){e=a(window)}else{if(h=="form"){e=d.parents("form").first()}else{if(i.latebind){i.getVal=g}else{e=g()}}}}}}}return i},compileParams:function(h,e,d){var i=a.extend({},h);if(i.dynamic){var f={};a.each(i.dynamic,function(j,m){var l={name:null,target:m,object:"jQuery",method:"val",methodparams:[]};if(typeof m==="object"&&!(m instanceof jQuery)){a.extend(l,m)}l=jsless.getSelector(l,e,d);var k=l.name||j;f[k]=function(){var n=l.getVal();var o=n;if(l.object!="jQuery"){o=window[l.object]}var p=o[l.method].apply(n,l.methodparams);return p}});i.dynamic=f}if(i.forms){var g=[];a.each(i.forms,function(k,l){var j=jsless.getSelector(l,e,d);g.push(j)});i.forms=g}return i},getParams:function(d){var g=a.extend({},d);var e={};if(g.dynamic){a.each(g.dynamic,function(j,m){var l=e;var k=null;a.each(j.split("."),function(n,o){if(k!=null){l=l[k]}if(l[o]===undefined){l[o]={}}k=o});l[k]=m()});delete g.dynamic}var f={};if(g.forms){a.each(g.forms,function(m,k){var j=k.getVal();var l=jsless.processContainer(j);a.extend(f,l)});delete g.forms}var i={};a.each(g,function(j,l){var k=j;if(j.indexOf("_dynamic")>0||j.indexOf("_forms")>0){k=j.substr(1)}i[k]=l});var h=a.extend(true,{},f,i,e);return h},getValue:function(d,h,g){var f=function(){var j=null;if(d.is("select")){d.find("option:selected").each(function(k,l){h=jsless.getValue(a(l),h,g)})}else{if(d.attr("contenteditable")!=null){j=d.html()}else{if(d.is("input:checkbox,input:radio")){if(d.is("input[value]")){if(d.is(":checked")){j=d.val()}}else{j=d.is(":checked");if(j=="on"){j=true}}}else{j=d.val()}}}return j};var e=f();if(e!=null){if(d.is("[data-type='enum'],[data-commalist]")){var i=h[g]||"";if(!d.is("input:checkbox,input:radio")||d.is(":checked")){if(i.length>0){i+=", "}i+=e}e=i}if(d.is("[data-index]")){h[g]=e}else{if(d.is("[data-list]")||d.is("select[multiple] option:selected")){h[g]=h[g]||[];h[g].push(e)}else{h[g]=e}}}return h},processContainer:function(e,i){var h="[name],[data-list],[data-index]";var k="input[type!='button'][type!='submit'],select,textarea,[contenteditable]";var f=e.find(h+","+k).filter(function(l){var m=a(this).parentsUntil(e,h).length==0;return m});var g=f.filter(k);var d=f.not(g);var j={};a.each(g,function(n,m){var l=a(m);var o=i;if(l.attr("data-list")){o=l.attr("data-list")}if(l.attr("data-name")){o=l.attr("data-name")}if(l.attr("data-index")!=null){o=(o||"")+"["+l.attr("data-index")+"]"}if(!o){o=l.attr("name")}if(o==null){c.warn("element has no name: "+l[0].outerHTML);return}var p=jsless.getValue(l,j,o);j=p});a.each(d,function(n,m){var l=a(m);var p=jsless.processContainer(l);if(l.attr("data-list")!=null){var o=l.attr("data-list");if(!jQuery.isEmptyObject(p)){if(l.attr("data-index")!=null){o=(o||"")+"["+l.attr("data-index")+"]";a.extend(j,jsless.processContainer(l,o))}else{j[o]=j[o]||[];j[o].push(p)}}}else{var o=l.attr("name");if(l.attr("data-index")!=null){o+="["+l.attr("data-index")+"]"}if(j[o]){p=a.extend({},j[o],p)}j[o]=p}});return j},_methods:{html:function(f,d,g,k){var l=a.extend(true,{},jsless.settings.method,k.method,{name:"html",url:null,method:"GET",event:"click",stopEventPropagation:false,onSuccess:"widget",onFail:null,params:{dynamic:{},forms:[]}},g);if(!l.url){c.error("html url not specified: "+JSON.stringify(l))}if(!l.onFail){l.onFail=l.onSuccess}var e=jsless.getSelector(l.eventSource,f,d).getVal();var m=jsless.getSelector(l.onSuccess,f,d);var i=jsless.getSelector(l.onFail,f,d);var h=jsless.compileParams(l.params,f,d);var j=function(n,o){l.eventData=o;jsless._methods.htmlevent(n,f,d,l,m,i,h,k)};if(l.event=="load"){f.one("jsless-widget-complete",j)}else{e.bind(l.event,j)}},htmlevent:function(j,g,d,r,t,l,i,n){var m="";c.debug(r.name+" event:"+r.event+"\r\n\t :: "+m);if(r.stopEventPropagation&&r.event!="load"){j.preventDefault()}var o=jsless.getParams(i);var f=t.getVal();var e=l.getVal();if(r.loading){var p=function(v){var u=a(a(r.loading).html());u.width(v.width());u.height(v.height());u.css("left",v[0].offsetLeft);u.css("top",v[0].offsetTop);v.append(u);u.show();d.bind("jsless-ajax-beforecomplete",function(){u.remove()})};p(f)}if(r.eventDataMap&&r.eventData){var k=jsless.dataMap(r.eventDataMap,r.eventData);a.extend(o,k)}var q=d.triggerHandler("jsless-"+r.name+"-begin",[i]);if(q===undefined||q){d.trigger("jsless-ajax-begin");f.triggerHandler("jsless-"+r.name+"-beforestart");e.triggerHandler("jsless-"+r.name+"-beforestart");var h={url:r.url,category:"normal",datatype:"json",method:r.method,subdomain:null,params:o,onComplete:function(w){w.success=w.success&&w.isHTML;var u=a(w.data);var x=jsless.processContainer(u.find("[data-jsless-params]"));if(u.attr("data-jsless-error")){w.success=false;w.errormessage=u.attr("data-jsless-error")}var y=t;var v=f;if(!w.success){y=l;v=e;d.trigger("jsless-ajax-beforefail");v.triggerHandler("jsless-"+r.name+"-beforefail",[x])}else{d.trigger("jsless-ajax-beforesuccess");v.triggerHandler("jsless-"+r.name+"-beforesuccess",[x])}d.trigger("jsless-ajax-beforecomplete");v.triggerHandler("jsless-"+r.name+"-beforecomplete",[x]);setTimeout(function(){a.each(v,function(C,B){var A=a(B);var z=u.clone();A[y.mode](z);z.jsless(n)});setTimeout(function(){if(w.success){d.trigger("jsless-ajax-success");v.triggerHandler("jsless-"+r.name+"-success",[x])}else{d.trigger("jsless-ajax-fail");v.triggerHandler("jsless-"+r.name+"-fail",[x])}d.trigger("jsless-ajax-complete");v.triggerHandler("jsless-"+r.name+"-complete",[x])},0)},0)},retryCount:0};var s=function(){if(f.parents("body").length==0){c.debug(r.name+" event:"+r.event+"\r\n\t :: $success is detached");return}jsless.invoke(h)};if(r.delay<0){s()}else{setTimeout(s,r.delay)}}},htmlform:function(f,d,g,h){var i=a.extend(true,{},jsless.settings.method,h.method,{name:"html",url:null,method:"GET",event:d.is("form")?"submit":"click",stopEventPropagation:d.is("form"),onSuccess:"widget",onFail:null,params:{dynamic:{},forms:[]}},g);if(i.params.forms.length==0){if(d.is("form")){c.log("element is form");i.params.forms.push(d)}else{var e=d.parentsUntil(f,"form");if(e.length==1){c.log("element is within form")}else{c.log("element is formless");e=d}i.params.forms.push(e)}}jsless._methods.html(f,d,i,h)}}};c.info("Loading Methods ...");window.jsless=a.extend(true,b,window.jsless||{})}(window.jQuery);/*
 * JSLess Library - Builtin Behaviors
 * https://github.com/realstrategos/JSLess
 * *
 * Copyright 2013 OptixConnect LLC and other contributors
 * Released under the Creative Commons Attribution NonCommercial (CC-NC)
 * http://creativecommons.org/licenses/by-nc/3.0/legalcode
 *
 */
!function(a){var c=jsless.logger;var b={settings:{behavior:{name:null,event:"click",eventSource:"self",target:"self",delay:-1,params:[],dynamic:[],stopEventPropagation:false}},behaviors:{execute:function(f,d,g,j){var k=a.extend(true,{},jsless.settings.behavior,j.behavior,{name:"execute",object:"jQuery",method:null},g);if(!k.method){c.error("execute method not specified: "+JSON.stringify(k))}var h={};a.each(k.dynamic,function(n,o){if(k.dynamic[n]==null){return}var m=jsless.compileParams({dynamic:k.dynamic[n]},f,d);h[n]=m});var e=jsless.getSelector(k.eventSource,f,d).getVal();var l=jsless.getSelector(k.target,f,d);var i=function(o,p){var q=k.params.slice(0);if(k.stopEventPropagation){o.stopPropagation()}c.debug(k.name+" event:"+k.event+" method: "+k.method+"\r\n\t :: "+JSON.stringify(k));var r=d.triggerHandler("jsless-"+k.name+"-begin");if(r===undefined||r){var m=l.getVal();a.each(h,function(s,t){var u=jsless.getParams(h[s]);if(typeof u==="object"){a.extend(true,q,u)}else{q[s]=u}});var n=function(){d.triggerHandler("jsless-"+k.name+"-beforecomplete");var t=m;var s=m[k.method];a.each(q,function(v,w){if(q[v]=="@event"){q[v]=o}if(q[v]=="@eventData"){q[v]=p}if(q[v]=="@target"){q[v]=m}if(w instanceof Function){q[v]=w()}});if(k.object!="jQuery"){var t=window;a.each(k.object.split("."),function(v,w){t=t[w]});var s=t[k.method]}var u=s.apply(t,q);d.triggerHandler("jsless-"+k.name+"-complete")};if(k.delay<0){n()}else{setTimeout(n,k.delay)}}};if(k.event=="load"){f.one("jsless-widget-complete",i)}else{e.bind(k.event,i)}},keyclick:function(f,d,g,h){var j=a.extend(true,{},jsless.settings.behavior,h.behavior,{name:"keyclick",event:"keydown",target:"self",keycode:13},g);var i=j.params;var e=jsless.getSelector(j.eventSource,f,d).getVal();var k=jsless.getSelector(j.target,f,d);e.bind(j.event,function(n){c.debug(j.name+" event:"+j.event+"\r\n\t :: "+JSON.stringify(j));var o=d.triggerHandler("jsless-"+j.name+"-begin");if(o===undefined||o){var m=(n.keyCode?n.keyCode:n.which);if(m==j.keycode){n.preventDefault();var l=k.getVal();l.triggerHandler("click")}}})},toggleClass:function(f,d,g,h){var j=a.extend(true,{},jsless.settings.behavior,h.behavior,{name:"toggleClass",className:null},g);if(!j.className){c.error("className not specified: "+JSON.stringify(j))}var i=j.params;var e=jsless.getSelector(j.eventSource,f,d).getVal();var k=jsless.getSelector(j.target,f,d);e.bind(j.event,function(o){c.debug(j.name+" event:"+j.event+"\r\n\t :: "+JSON.stringify(j));var p=d.triggerHandler("jsless-"+j.name+"-begin");if(p===undefined||p){var m=k.getVal();var l=a(o.target).parents(j.target).addBack(j.target).first();var n=j.className;m.removeClass(n);l.addClass(n)}})},parentTrigger:function(f,d,g,i){var j=a.extend(true,{},jsless.settings.behavior,i.method,{name:"parentTrigger",eventSource:"widget",parentSelector:"[data-jsless-widget]",parentEvent:"jsless-reload",level:1},g);var e=jsless.getSelector(j.eventSource,f,d).getVal();var h=function(l,m){var k=e;if(j.level>0){k=a(k.parents(j.parentSelector)[j.level-1])}k.triggerHandler(j.parentEvent,m)};if(j.event=="load"){f.one("jsless-widget-complete",h)}else{e.bind(j.event,h)}}}};c.info("Loading Behaviors ...");window.jsless=a.extend(true,b,window.jsless||{})}(window.jQuery);